<!-- ğŸ’¬ Loan Chatbot Embed -->
<div id="chatbot-container"
     style="position: fixed; bottom: 20px; right: 20px; width: 380px; height: 500px;
            border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            overflow: hidden; display: flex; flex-direction: column;
            background: white; font-family: Arial, sans-serif; z-index: 9999;">

  <div style="background: #0056b3; color: white; padding: 12px; text-align: center; font-weight: bold;">
    ğŸ¦ Loan Advisor Chatbot
  </div>

  <div id="chat-window"
       style="flex: 1; padding: 10px; overflow-y: auto; background: #f5f5f5;">
    <div style="color: gray; text-align: center; margin-top: 20px;">
      ğŸ‘‹ Hello! Iâ€™m your Loan Advisor. How can I help today?
    </div>
  </div>

  <div style="display: flex; border-top: 1px solid #ccc;">
    <input id="user-input" type="text" placeholder="Type a message..."
           style="flex: 1; padding: 10px; border: none; outline: none;">
    <button id="send-btn"
            style="background: #0056b3; color: white; border: none; padding: 10px 15px; cursor: pointer;">
      â¤
    </button>
  </div>
</div>

<script>
const API_URL = "https://loan-chatbot.onrender.com/chat"; // ğŸ§  replace with your actual endpoint

const chatWindow = document.getElementById("chat-window");
const userInput = document.getElementById("user-input");
const sendBtn = document.getElementById("send-btn");

function appendMessage(sender, text) {
  const msg = document.createElement("div");
  msg.style.margin = "8px 0";
  msg.innerHTML = sender === "user"
    ? `<div style="text-align: right;"><span style="background:#0056b3; color:white; padding:8px 12px; border-radius:12px; display:inline-block;">${text}</span></div>`
    : `<div style="text-align: left;"><span style="background:#e4e6eb; padding:8px 12px; border-radius:12px; display:inline-block;">${text}</span></div>`;
  chatWindow.appendChild(msg);
  chatWindow.scrollTop = chatWindow.scrollHeight;
}

async function sendMessage() {
  const text = userInput.value.trim();
  if (!text) return;

  appendMessage("user", text);
  userInput.value = "";

  try {
    const response = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: text })
    });

    const data = await response.json();
    appendMessage("bot", data.reply || "Sorry, I didnâ€™t understand that.");
  } catch (error) {
    appendMessage("bot", "âš ï¸ Error connecting to chatbot server.");
    console.error(error);
  }
}

sendBtn.onclick = sendMessage;
userInput.addEventListener("keypress", e => {
  if (e.key === "Enter") sendMessage();
});
</script>
